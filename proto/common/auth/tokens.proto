syntax = "proto3";

package geniustechspace.common.auth.v1;

import "google/protobuf/timestamp.proto";
import "common/enums.proto";

// Language-specific code generation options
option go_package = "github.com/geniustechspace/api-contracts/gen/go/common/auth/v1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.api.common.auth.v1";

// =============================================================================
// AUTHENTICATION & AUTHORIZATION TOKEN
// =============================================================================

// Token represents an authentication or authorization token.
//
// USAGE:
// - Access tokens, refresh tokens, API keys
// - OAuth 2.0 and OpenID Connect flows
// - Session management
//
// SECURITY:
// - Never log token values
// - Encrypt tokens at rest
// - Use HTTPS for token transmission
//
// COMPLIANCE:
// - NIST 800-63B: Token-based authentication
// - OAuth 2.0: RFC 6749 token handling
// - PCI DSS: Secure key management
message Token {
  // Opaque token value (JWT, random string, etc.).
  // USAGE: Bearer token for Authorization header
  // FORMAT: JWT (recommended), random base64 string, UUID
  // SECURITY: Never log, encrypt at rest, transmit over HTTPS only
  // LENGTH: 128-512 bytes recommended
  string value = 1;

  // Token type for Authorization header.
  // USAGE: Specify authentication scheme
  // EXAMPLE: "Bearer", "Basic", "API-Key"
  // STANDARD: OAuth 2.0 token types (RFC 6749)
  string token_type = 2;

  // Optional refresh token for obtaining new access tokens.
  // USAGE: OAuth 2.0 refresh token flow
  // SECURITY: More sensitive than access tokens, stricter rotation
  // LIFETIME: Longer than access tokens (days/weeks vs minutes/hours)
  string refresh_token = 5;

  // Scopes or permissions associated with this token.
  // USAGE: Fine-grained authorization, principle of least privilege
  // EXAMPLE: ["read:users", "write:posts", "admin:settings"]
  // FORMAT: Colon-separated namespace:action or custom format
  repeated string scopes = 6;

  // Subject identifier (user ID, service account ID, etc.).
  // USAGE: Identify the principal the token represents
  // FORMAT: UUID, email, or service principal name
  // COMPLIANCE: Required for audit trails
  string subject = 7;

  // Token issuer identifier.
  // USAGE: Multi-tenant systems, federation scenarios
  // EXAMPLE: "auth.example.com", "https://accounts.google.com"
  // FORMAT: Domain or URL of the authentication service
  string issuer = 8;

  // Token audience (intended recipient).
  // USAGE: Prevent token misuse across services
  // EXAMPLE: "api.example.com", "service-a"
  // VALIDATION: Services should verify audience matches
  string audience = 9;

  // Token expiration timestamp.
  // USAGE: Validate token freshness, implement token rotation
  // COMPLIANCE: NIST 800-63B - Tokens must expire
  // RECOMMENDATION:
  //   - Access tokens: 15-60 minutes
  //   - Refresh tokens: 1-30 days
  //   - API keys: 90-365 days
  google.protobuf.Timestamp expires_at = 3;

  // When the token was issued.
  // USAGE: Calculate token age, audit token usage
  // FORMAT: UTC timezone
  google.protobuf.Timestamp issued_at = 4;
}
