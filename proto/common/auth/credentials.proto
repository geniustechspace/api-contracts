syntax = "proto3";

package geniustechspace.common.auth.v1;

import "google/protobuf/timestamp.proto";
import "common/enums.proto";

// Language-specific code generation options
option go_package = "github.com/geniustechspace/api-contracts/gen/go/common/auth/v1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.api.common.auth.v1";


// =============================================================================
// AUTHENTICATION CREDENTIALS
// =============================================================================

// Credentials for username/password authentication.
//
// USAGE:
// - Login operations
// - Basic authentication
// - Password reset flows
//
// SECURITY:
// - Never log passwords
// - Always hash passwords server-side
// - Enforce strong password policies
// - Use HTTPS for credential transmission
//
// COMPLIANCE:
// - NIST 800-63B: Digital identity guidelines
// - OAuth 2.0: RFC 6749
// - PCI DSS: Secure credential transmission and storage

message Credentials {
  // Username, email, phone number, or unique identifier.
  // USAGE: User identification for authentication
  // FORMAT: Email, username, phone number, or UUID
  // VALIDATION: Non-empty, valid format
  string username = 1;

  // User password (plaintext, must be hashed server-side).
  // USAGE: Authentication credential
  // SECURITY:
  //   - NEVER store plaintext passwords
  //   - Hash with bcrypt, scrypt, or Argon2
  //   - Minimum 8 characters (recommend 12+)
  //   - Enforce complexity requirements
  // COMPLIANCE: NIST 800-63B - Password guidelines
  string password = 2;

  // Optional multi-factor authentication code.
  // USAGE: Second factor for 2FA/MFA
  // FORMAT: 6-digit TOTP, SMS code, or longer backup code
  // EXPIRATION: Typically 30-60 seconds for TOTP
  string mfa_code = 3;

  // MFA method used (if applicable).
  // USAGE: Specify which MFA mechanism was used
  // EXAMPLE: "totp", "sms", "email", "hardware_key"
  // COMPLIANCE: NIST 800-63B - MFA authentication
  MFAMethod mfa_method = 4;

  // Optional device identifier for device-based authentication.
  // USAGE: Remember trusted devices, device fingerprinting
  // FORMAT: UUID or device fingerprint hash
  // SECURITY: Use secure device fingerprinting techniques
  string device_id = 5;

  // Whether to create a long-lived session ("remember me").
  // USAGE: Extended session lifetime for trusted devices
  // SECURITY: Increase token lifetime (e.g., from 1 hour to 30 days)
  // RISK: Balance convenience vs security
  bool remember_me = 6;

  // Metadata for authentication context.
  // USAGE: Additional info auth method context
  // FORMAT: JSON key-value pairs
  // SECURITY: Avoid sensitive info in metadata
  map<string, string> metadata = 7;
}
