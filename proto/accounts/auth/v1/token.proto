syntax = "proto3";

package geniustechspace.accounts.auth.v1;

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";
import "common/types.proto";

option go_package = "github.com/geniustechspace/api-contracts/gen/go/auth/v1";
option java_multiple_files = true;
option java_package = "com.genitechspace.api.auth.v1";


// RefreshTokenRequest contains a refresh token
message RefreshTokenRequest {
  // JWT refresh token
  string refresh_token = 1;
}

// RefreshTokenResponse contains new authentication tokens
message RefreshTokenResponse {
  // New JWT access token
  string access_token = 1;

  // New JWT refresh token (optional, may reuse existing)
  string refresh_token = 2;

  // Access token expiration timestamp
  google.protobuf.Timestamp expires_at = 3;
}

// VerifyTokenRequest contains a token to verify
message VerifyTokenRequest {
  // JWT token to verify
  string token = 1;
}

// VerifyTokenResponse contains token validation results
message VerifyTokenResponse {
  // Whether the token is valid
  bool valid = 1;

  // User ID extracted from token
  string user_id = 2;

  // User's email extracted from token
  string email = 3;

  // Token expiration timestamp
  google.protobuf.Timestamp expires_at = 4;

  // User's roles from token
  repeated string roles = 5;
}
